<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PulseDeck Song Player</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="bg-shape shape-a"></div>
    <div class="bg-shape shape-b"></div>

    <svg class="icon-sprite" aria-hidden="true" focusable="false">
      <symbol id="icon-add" viewBox="0 0 24 24">
        <path d="M12 5v14M5 12h14" />
      </symbol>
      <symbol id="icon-folder" viewBox="0 0 24 24">
        <path d="M3 7h6l2 2h10v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
      </symbol>
      <symbol id="icon-link" viewBox="0 0 24 24">
        <path d="M10 14l4-4" />
        <path d="M7.5 16.5a3.5 3.5 0 0 1 0-5l2-2a3.5 3.5 0 1 1 5 5l-1 1" />
        <path d="M16.5 7.5a3.5 3.5 0 0 1 0 5l-2 2a3.5 3.5 0 1 1-5-5l1-1" />
      </symbol>
      <symbol id="icon-heart" viewBox="0 0 24 24">
        <path d="M12 20s-7-4.6-7-10a4 4 0 0 1 7-2.6A4 4 0 0 1 19 10c0 5.4-7 10-7 10z" />
      </symbol>
      <symbol id="icon-prev" viewBox="0 0 24 24">
        <path d="M7 6v12" />
        <path d="M18 6l-8 6 8 6z" />
      </symbol>
      <symbol id="icon-play" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="icon-pause" viewBox="0 0 24 24">
        <path d="M8 5h3v14H8zM13 5h3v14h-3z" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="icon-next" viewBox="0 0 24 24">
        <path d="M17 6v12" />
        <path d="M6 6l8 6-8 6z" />
      </symbol>
      <symbol id="icon-shuffle" viewBox="0 0 24 24">
        <path d="M4 7h3l10 10h3" />
        <path d="M17 5h3v3" />
        <path d="M4 17h3l3-3" />
        <path d="M17 19h3v-3" />
      </symbol>
      <symbol id="icon-repeat" viewBox="0 0 24 24">
        <path d="M4 9V6h14" />
        <path d="M18 3l3 3-3 3" />
        <path d="M20 15v3H6" />
        <path d="M6 21l-3-3 3-3" />
      </symbol>
      <symbol id="icon-volume-high" viewBox="0 0 24 24">
        <path d="M4 10h4l5-4v12l-5-4H4z" />
        <path d="M16 9a4 4 0 0 1 0 6" />
        <path d="M18.5 6.5a7.5 7.5 0 0 1 0 11" />
      </symbol>
      <symbol id="icon-volume-low" viewBox="0 0 24 24">
        <path d="M4 10h4l5-4v12l-5-4H4z" />
        <path d="M16 9a4 4 0 0 1 0 6" />
      </symbol>
      <symbol id="icon-volume-mute" viewBox="0 0 24 24">
        <path d="M4 10h4l5-4v12l-5-4H4z" />
        <path d="M17 9l4 4M21 9l-4 4" />
      </symbol>
      <symbol id="icon-trash" viewBox="0 0 24 24">
        <path d="M4 7h16" />
        <path d="M9 7V5h6v2" />
        <path d="M7 7l1 12h8l1-12" />
      </symbol>
      <symbol id="icon-clear" viewBox="0 0 24 24">
        <path d="M6 6l12 12M18 6L6 18" />
      </symbol>
      <symbol id="icon-star" viewBox="0 0 24 24">
        <path d="M12 3l2.7 5.4 6 0.9-4.3 4.2 1 6-5.4-2.8-5.4 2.8 1-6-4.3-4.2 6-0.9z" />
      </symbol>
      <symbol id="icon-image" viewBox="0 0 24 24">
        <rect x="3" y="5" width="18" height="14" rx="2" ry="2" />
        <circle cx="9" cy="10" r="1.8" />
        <path d="M4 17l5.5-5 3.7 3.6 2.7-2.5 4.1 4.1" />
      </symbol>
      <symbol id="icon-undo" viewBox="0 0 24 24">
        <path d="M8 7H3v5" />
        <path d="M3 12a8 8 0 1 0 2.3-5.7L8 7" />
      </symbol>
      <symbol id="icon-up" viewBox="0 0 24 24">
        <path d="M12 6l-5 6h10z" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="icon-down" viewBox="0 0 24 24">
        <path d="M12 18l5-6H7z" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="icon-drag" viewBox="0 0 24 24">
        <path d="M9 8h6M9 12h6M9 16h6" />
      </symbol>
      <symbol id="icon-more" viewBox="0 0 24 24">
        <circle cx="6" cy="12" r="1.6" fill="currentColor" stroke="none" />
        <circle cx="12" cy="12" r="1.6" fill="currentColor" stroke="none" />
        <circle cx="18" cy="12" r="1.6" fill="currentColor" stroke="none" />
      </symbol>
      <symbol id="icon-settings" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="2.6" />
        <path d="M19.4 15a1.7 1.7 0 0 0 .34 1.88l.05.05a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.05-.05a1.7 1.7 0 0 0-1.88-.34 1.7 1.7 0 0 0-1 1.56V21a2 2 0 1 1-4 0v-.08a1.7 1.7 0 0 0-1-1.56 1.7 1.7 0 0 0-1.88.34l-.05.05a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.05-.05a1.7 1.7 0 0 0 .34-1.88 1.7 1.7 0 0 0-1.56-1H3a2 2 0 1 1 0-4h.08a1.7 1.7 0 0 0 1.56-1 1.7 1.7 0 0 0-.34-1.88l-.05-.05a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.05.05a1.7 1.7 0 0 0 1.88.34h0a1.7 1.7 0 0 0 1-1.56V3a2 2 0 1 1 4 0v.08a1.7 1.7 0 0 0 1 1.56 1.7 1.7 0 0 0 1.88-.34l.05-.05a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.05.05a1.7 1.7 0 0 0-.34 1.88v0a1.7 1.7 0 0 0 1.56 1H21a2 2 0 1 1 0 4h-.08a1.7 1.7 0 0 0-1.56 1z" />
      </symbol>
    </svg>

    <main class="app-shell">
      <header class="topbar reveal">
        <div>
          <h1>PulseDeck</h1>
        </div>

        <div class="topbar-actions">
          <div class="link-actions">
            <input
              id="song-link-input"
              class="link-input"
              type="url"
              placeholder="https://example.com/song.mp3"
            />
            <button id="play-link-btn" class="btn-ghost">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-link"></use></svg>
              <span class="btn-loader" aria-hidden="true"></span>
              <span class="btn-label">Play Link</span>
            </button>
            <span id="link-loader-text" class="link-loader-text" aria-live="polite" hidden></span>
          </div>

          <div class="import-actions">
            <button id="add-files-btn" class="btn-primary">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-add"></use></svg>
              <span class="btn-label">Add Songs</span>
            </button>
            <button id="add-folder-btn" class="btn-ghost">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-folder"></use></svg>
              <span class="btn-label">Add Folder</span>
            </button>
            <button id="open-settings-btn" class="btn-ghost icon-only" aria-label="Open app settings" title="Settings">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-settings"></use></svg>
            </button>
          </div>
        </div>
      </header>

      <section class="player-card reveal delay-1">
        <div id="cover-glow" class="cover-glow"></div>
        <div class="player-grid">
          <div class="cover-column">
            <div id="cover-wrap" class="cover-wrap">
              <img id="cover-image" alt="Current song cover art" />
              <div id="cover-fallback" class="cover-fallback">
                <p>PulseDeck</p>
                <span>No Cover</span>
              </div>
            </div>
          </div>

          <div class="meta-column">
            <div class="track-meta">
              <div class="track-meta-top">
                <p class="eyebrow">Now Playing</p>
                <button id="like-current-btn" class="btn-ghost btn-like-now">
                  <svg class="btn-icon" aria-hidden="true"><use href="#icon-heart"></use></svg>
                  <span class="btn-label">Like</span>
                </button>
              </div>
              <h2 id="track-title">No song loaded</h2>
              <p id="track-subtitle">Import songs to start listening.</p>
              <p id="track-path">-</p>
            </div>

            <div class="transport-row">
              <button id="prev-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-prev"></use></svg>
                <span class="btn-label">Prev</span>
              </button>
              <button id="play-btn" class="btn-primary">
                <svg class="btn-icon" aria-hidden="true"><use id="play-icon-use" href="#icon-play"></use></svg>
                <span class="btn-label">Play</span>
              </button>
              <button id="next-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-next"></use></svg>
                <span class="btn-label">Next</span>
              </button>
              <button id="shuffle-btn" class="btn-toggle">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-shuffle"></use></svg>
                <span class="btn-label">Shuffle Off</span>
              </button>
              <button id="repeat-btn" class="btn-toggle">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-repeat"></use></svg>
                <span class="btn-label">Repeat Off</span>
              </button>
            </div>

            <div class="seek-row">
              <span id="current-time">0:00</span>
              <input id="seek-slider" type="range" min="0" max="100" value="0" />
              <span id="duration">0:00</span>
            </div>

            <div class="volume-row">
              <div id="volume-control" class="volume-control">
                <button id="volume-btn" class="btn-ghost icon-only" aria-label="Mute or unmute">
                  <svg class="btn-icon" aria-hidden="true"><use id="volume-icon-use" href="#icon-volume-high"></use></svg>
                </button>
                <div class="volume-popover">
                  <input
                    id="volume-slider"
                    type="range"
                    min="0"
                    max="1"
                    step="0.01"
                    value="0.85"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="playlist-card reveal delay-2">
        <div class="playlist-header">
          <div class="playlist-title-group">
            <h3>Playlists</h3>
            <p id="favorites-summary" class="favorites-summary">0 favorites</p>
          </div>
          <div class="playlist-actions">
            <button
              id="remove-btn"
              class="btn-ghost icon-only"
              aria-label="Toggle song delete mode"
              title="Toggle song delete mode"
            >
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-trash"></use></svg>
            </button>
            <button id="clear-btn" class="btn-danger">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-clear"></use></svg>
              <span class="btn-label">Clear Playlist</span>
            </button>
          </div>
        </div>

        <div class="playlist-layout">
          <aside class="playlist-sidebar">
            <div id="playlist-tabs" class="playlist-tabs"></div>
            <div id="playlist-cover-preview" class="playlist-cover-preview playlist-cover-preview-hidden" aria-hidden="true">
              <img id="playlist-cover-image" alt="Active playlist cover" />
              <span id="playlist-cover-fallback">PL</span>
            </div>
            <button
              id="open-playlist-builder-btn"
              class="btn-ghost icon-only playlist-add-btn"
              aria-label="Create playlist"
              title="Create playlist"
            >
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-add"></use></svg>
            </button>
          </aside>

          <div class="playlist-main">
            <div class="playlist-toolbar">
              <input
                id="search-input"
                class="playlist-search"
                type="search"
                placeholder="Search in title or file path"
              />
              <button id="favorites-filter-btn" class="btn-toggle">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-star"></use></svg>
                <span class="btn-label">All Songs</span>
              </button>
            </div>

            <p id="empty-state" class="empty-state">
              No songs yet. Click "Add Songs" or import an entire folder.
            </p>
            <ul id="playlist" class="playlist"></ul>
          </div>
        </div>
      </section>
    </main>

    <div id="playlist-builder-backdrop" class="playlist-builder-backdrop" hidden></div>
    <div
      id="playlist-builder-panel"
      class="playlist-builder-panel"
      role="dialog"
      aria-modal="true"
      aria-labelledby="playlist-builder-title"
      hidden
    >
      <div class="builder-layout">
        <aside class="builder-sidebar">
          <div class="builder-sidebar-header">
            <h4 id="playlist-builder-title">Playlists</h4>
            <button id="builder-new-playlist-btn" class="btn-primary">
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-add"></use></svg>
              <span class="btn-label">New</span>
            </button>
          </div>
          <ul id="builder-playlist-list" class="builder-playlist-list"></ul>
        </aside>

        <div class="builder-main">
          <section class="builder-section">
            <h4 class="builder-section-title">Create Playlist</h4>
            <div class="builder-fields">
              <input
                id="builder-playlist-name-input"
                class="playlist-name-input"
                type="text"
                placeholder="Playlist name"
                maxlength="80"
              />
              <input
                id="builder-song-search-input"
                class="playlist-search"
                type="search"
                placeholder="Search songs to add"
              />
            </div>

            <div class="builder-cover-row">
              <div id="builder-cover-preview" class="playlist-cover-preview" title="Playlist cover preview">
                <img id="builder-cover-image" alt="Builder playlist cover" />
                <span id="builder-cover-fallback">PL</span>
              </div>
              <button id="builder-set-cover-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-image"></use></svg>
                <span class="btn-label">Set Cover</span>
              </button>
              <button id="builder-clear-cover-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-undo"></use></svg>
                <span class="btn-label">Clear Cover</span>
              </button>
            </div>

            <div class="builder-actions-row">
              <button id="builder-use-active-playlist-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-star"></use></svg>
                <span class="btn-label">Use Main List</span>
              </button>
              <button id="builder-add-system-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-folder"></use></svg>
                <span class="btn-label">Add From System</span>
              </button>
            </div>

            <p id="builder-empty-state" class="builder-empty-state">
              No songs yet. Use "Use Main List" or "Add From System".
            </p>
            <ul id="builder-song-list" class="builder-song-list"></ul>

            <div class="builder-footer">
              <button id="builder-cancel-btn" class="btn-ghost">
                <span class="btn-label">Cancel</span>
              </button>
              <button id="builder-create-btn" class="btn-primary">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-add"></use></svg>
                <span class="btn-label">Create Playlist</span>
              </button>
            </div>
          </section>

          <section id="builder-settings-panel" class="builder-section builder-settings-panel" hidden>
            <div class="builder-settings-header">
              <h4 class="builder-section-title">Playlist Settings</h4>
              <button id="builder-settings-open-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-star"></use></svg>
                <span class="btn-label">Open</span>
              </button>
            </div>

            <input
              id="builder-settings-name-input"
              class="playlist-name-input"
              type="text"
              placeholder="Playlist name"
              maxlength="80"
            />

            <div class="builder-cover-row">
              <div
                id="builder-settings-cover-preview"
                class="playlist-cover-preview"
                title="Selected playlist cover"
              >
                <img id="builder-settings-cover-image" alt="Selected playlist cover" />
                <span id="builder-settings-cover-fallback">PL</span>
              </div>
              <button id="builder-settings-set-cover-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-image"></use></svg>
                <span class="btn-label">Set Cover</span>
              </button>
              <button id="builder-settings-clear-cover-btn" class="btn-ghost">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-undo"></use></svg>
                <span class="btn-label">Clear Cover</span>
              </button>
            </div>

            <div class="builder-footer">
              <button id="builder-settings-save-btn" class="btn-primary">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-add"></use></svg>
                <span class="btn-label">Save Settings</span>
              </button>
              <button id="builder-settings-delete-btn" class="btn-danger">
                <svg class="btn-icon" aria-hidden="true"><use href="#icon-trash"></use></svg>
                <span class="btn-label">Delete Playlist</span>
              </button>
            </div>
          </section>
        </div>
      </div>
    </div>

    <div id="app-settings-backdrop" class="settings-backdrop" hidden></div>
    <div
      id="app-settings-panel"
      class="settings-panel"
      role="dialog"
      aria-modal="true"
      aria-labelledby="app-settings-title"
      hidden
    >
      <div class="settings-header">
        <h4 id="app-settings-title">Player Settings</h4>
        <button id="close-settings-btn" class="btn-ghost icon-only" aria-label="Close settings">
          <svg class="btn-icon" aria-hidden="true"><use href="#icon-clear"></use></svg>
        </button>
      </div>

      <div class="settings-body">
        <label class="settings-row settings-toggle-row" for="settings-autoplay-toggle">
          <span>Auto Play On Startup</span>
          <span class="settings-switch">
            <input id="settings-autoplay-toggle" type="checkbox" />
            <span class="settings-switch-track" aria-hidden="true">
              <span class="settings-switch-thumb"></span>
            </span>
          </span>
        </label>

        <label class="settings-row settings-toggle-row" for="settings-startup-toggle">
          <span>Launch When Windows Starts</span>
          <span class="settings-switch">
            <input id="settings-startup-toggle" type="checkbox" />
            <span class="settings-switch-track" aria-hidden="true">
              <span class="settings-switch-thumb"></span>
            </span>
          </span>
        </label>

        <div class="settings-row">
          <span>Theme Accent Color</span>
          <div class="settings-theme-controls">
            <input id="settings-theme-color-input" type="color" value="#25d061" />
            <input
              id="settings-theme-color-text"
              class="settings-color-text"
              type="text"
              maxlength="7"
              placeholder="#25d061"
            />
            <button id="settings-theme-reset-btn" class="btn-ghost">
              <span class="btn-label">Reset</span>
            </button>
          </div>
        </div>

        <div class="settings-row">
          <label for="settings-output-device-select">Output Device</label>
          <div class="settings-output-controls">
            <div class="settings-select-wrap">
              <select id="settings-output-device-select" class="settings-select"></select>
              <svg class="settings-select-icon" aria-hidden="true"><use href="#icon-down"></use></svg>
            </div>
            <button
              id="settings-refresh-devices-btn"
              class="btn-ghost icon-only"
              aria-label="Refresh output devices"
              title="Refresh devices"
            >
              <svg class="btn-icon" aria-hidden="true"><use href="#icon-undo"></use></svg>
            </button>
          </div>
          <p id="settings-output-hint" class="settings-hint"></p>
        </div>
      </div>
    </div>

    <audio id="audio-player" preload="metadata"></audio>
    <script src="./renderer.js"></script>
  </body>
</html>
